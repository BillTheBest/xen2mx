LINUX_DIR	=	@LINUX_BUILD@
MPOE_DIR	=	@abs_builddir@

.PHONY: all clean wc

all:
	@echo Linking kernel module source files to local directory
	@for file in $(wildcard @srcdir@/*.[ch]) ; do ln -sf $$file ; done
	@echo Building kernel module
	make -C $(LINUX_DIR) M=$(MPOE_DIR)

clean:
	@echo Cleaning kernel module build
	make -C $(LINUX_DIR) M=$(MPOE_DIR) clean
	@echo Removing links to kernel module source files in local directory
	@for file in $(wildcard @srcdir@/*.[ch]) ; do rm -f $$(basename $$file) ; done

wc:
	wc -cl *.[ch]
