TESTS	=	mpoe_basic \
		mpoe_info \
		mpoe_large \
		mpoe_pingpong \
		mpoe_reg

CC	=	gcc

CFLAGS	=	-Wall
CFLAGS	+=	-g -O2
CFLAGS	+=	-imacros @top_builddir@/common/mpoe_config.h
CFLAGS	+=	-I@top_srcdir@/common -I@top_srcdir@/libmpoe

LD	=	gcc

LIB	=	@top_builddir@/@LIBMPOE_A@

.PHONY: all clean distclean $(TESTS)

all: $(TESTS)

$(TESTS): %: %.o
	$(LD) $^ $(LIB) -o $@

%.o: @srcdir@/%.c @top_srcdir@/libmpoe/mpoe_lib.h @top_srcdir@/libmpoe/mpoe_internals.h
	$(CC) -c $(CFLAGS) $< -o $@

clean:
	$(RM) $(TESTS) *.o

distclean: clean
